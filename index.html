<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shop - Premium Store</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 50%, #0a0a0a 100%);
      color: #e0e0e0;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Loading Overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s ease;
    }

    .loading-overlay.active {
      display: flex;
    }

    .loading-content {
      text-align: center;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 5px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #00ffff;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      color: #00ffff;
      font-size: 18px;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Notification Toast */
    .notification-toast {
      position: fixed;
      top: 80px;
      right: 20px;
      background: rgba(0, 0, 0, 0.95);
      border: 1px solid #00ffff;
      border-radius: 12px;
      padding: 15px 20px;
      color: #00ffff;
      z-index: 10001;
      display: none;
      animation: slideInRight 0.4s ease;
      box-shadow: 0 8px 32px rgba(0, 255, 255, 0.4);
      max-width: 350px;
      backdrop-filter: blur(20px);
    }

    @keyframes slideInRight {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .notification-toast.show {
      display: block;
    }

    .notification-toast.success {
      border-color: #00ff88;
      color: #00ff88;
    }

    .notification-toast.error {
      border-color: #ff006e;
      color: #ff006e;
    }

    /* Header */
    .header {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding: 15px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.1);
      animation: slideDown 0.5s ease;
    }

    @keyframes slideDown {
      from {
        transform: translateY(-100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .hamburger {
      width: 30px;
      height: 25px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      cursor: pointer;
      z-index: 1001;
      transition: transform 0.3s ease;
    }

    .hamburger:hover {
      transform: scale(1.1);
    }

    .hamburger span {
      width: 100%;
      height: 3px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border-radius: 3px;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }

    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translateY(10px);
    }

    .hamburger.active span:nth-child(2) {
      opacity: 0;
      transform: translateX(-20px);
    }

    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translateY(-10px);
    }

    .brand-section {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
      justify-content: center;
      animation: fadeIn 0.6s ease 0.2s both;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .brand-logo {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      object-fit: cover;
      border: 2px solid #00ffff;
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.4);
      transition: all 0.3s ease;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    .brand-logo:hover {
      transform: scale(1.1) rotate(5deg);
      box-shadow: 0 0 25px rgba(0, 255, 255, 0.6);
    }

    .brand-name {
      font-size: 20px;
      font-weight: bold;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradient 3s ease infinite;
      background-size: 200% 200%;
    }

    @keyframes gradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .header-icons {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .header-icon {
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #00ffff;
      font-size: 16px;
      position: relative;
    }

    .header-icon:hover {
      background: rgba(0, 255, 255, 0.1);
      border-color: #00ffff;
      transform: translateY(-2px) rotate(5deg);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.4);
    }

    .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: linear-gradient(135deg, #ff006e, #ff4d00);
      color: #fff;
      font-size: 10px;
      font-weight: bold;
      padding: 2px 6px;
      border-radius: 10px;
      min-width: 18px;
      text-align: center;
      animation: bounce 1s ease infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    /* Sidebar Menu */
    .sidebar {
      position: fixed;
      top: 0;
      left: -300px;
      width: 280px;
      height: 100vh;
      background: linear-gradient(180deg, rgba(26, 10, 46, 0.98) 0%, rgba(10, 10, 10, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(0, 255, 255, 0.3);
      padding: 80px 20px 20px;
      transition: left 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 999;
      overflow-y: auto;
      box-shadow: 4px 0 24px rgba(0, 255, 255, 0.2);
    }

    .sidebar.active {
      left: 0;
    }

    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s ease;
      z-index: 998;
      backdrop-filter: blur(5px);
    }

    .sidebar-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .menu-item {
      padding: 15px 20px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #00ffff;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 12px;
      animation: slideInLeft 0.4s ease backwards;
      position: relative;
      overflow: hidden;
    }

    .menu-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .menu-item:hover::before {
      left: 100%;
    }

    .menu-item:nth-child(1) { animation-delay: 0.1s; }
    .menu-item:nth-child(2) { animation-delay: 0.15s; }
    .menu-item:nth-child(3) { animation-delay: 0.2s; }
    .menu-item:nth-child(4) { animation-delay: 0.25s; }
    .menu-item:nth-child(5) { animation-delay: 0.3s; }
    .menu-item:nth-child(6) { animation-delay: 0.35s; }
    .menu-item:nth-child(7) { animation-delay: 0.4s; }
    .menu-item:nth-child(8) { animation-delay: 0.45s; }

    @keyframes slideInLeft {
      from {
        transform: translateX(-50px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .menu-item:hover {
      background: rgba(0, 255, 255, 0.15);
      border-color: #00ffff;
      transform: translateX(5px) scale(1.02);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.3);
    }

    .menu-item i {
      font-size: 18px;
      width: 24px;
      text-align: center;
    }

    .menu-username {
      padding: 20px;
      margin-bottom: 20px;
      background: linear-gradient(135deg, rgba(0, 255, 255, 0.15), rgba(168, 85, 247, 0.15));
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 16px;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      color: #00ffff;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
      animation: slideInLeft 0.4s ease backwards;
      position: relative;
      overflow: hidden;
    }

    .menu-username::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: rotate(45deg);
      animation: shine 3s ease-in-out infinite;
    }

    @keyframes shine {
      0% { top: -50%; right: -50%; }
      100% { top: 150%; right: 150%; }
    }

    /* Search Bar */
    .search-container {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
      animation: fadeInUp 0.6s ease 0.3s both;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .search-wrapper {
      position: relative;
    }

    .search-bar {
      width: 100%;
      padding: 15px 50px 15px 20px;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(0, 255, 255, 0.3);
      border-radius: 16px;
      color: #fff;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .search-bar:focus {
      outline: none;
      border-color: #00ffff;
      box-shadow: 0 0 24px rgba(0, 255, 255, 0.4);
      background: rgba(255, 255, 255, 0.08);
      transform: scale(1.02);
    }

    .search-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #00ffff;
      font-size: 18px;
      pointer-events: none;
      animation: pulse 2s ease-in-out infinite;
    }

    /* Cart Sidebar */
    .cart-sidebar {
      position: fixed;
      top: 0;
      right: -400px;
      width: min(400px, 90vw);
      height: 100vh;
      background: linear-gradient(180deg, rgba(26, 10, 46, 0.98) 0%, rgba(10, 10, 10, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-left: 1px solid rgba(0, 255, 255, 0.3);
      z-index: 999;
      transition: right 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      overflow-y: auto;
      box-shadow: -4px 0 24px rgba(0, 255, 255, 0.2);
      padding: 20px;
    }

    .cart-sidebar.active {
      right: 0;
    }

    .cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(0, 255, 255, 0.2);
    }

    .cart-title {
      font-size: 24px;
      color: #00ffff;
      font-weight: bold;
    }

    .cart-close {
      width: 35px;
      height: 35px;
      background: rgba(255, 0, 110, 0.2);
      border: 1px solid #ff006e;
      border-radius: 50%;
      color: #ff006e;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .cart-close:hover {
      background: #ff006e;
      color: #fff;
      transform: rotate(90deg);
    }

    .cart-item {
      display: flex;
      gap: 15px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      margin-bottom: 15px;
      border: 1px solid rgba(0, 255, 255, 0.2);
      animation: slideInRight 0.4s ease;
      transition: all 0.3s ease;
    }

    .cart-item:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateX(-5px);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.2);
    }

    .cart-item-image {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .cart-item-details {
      flex: 1;
    }

    .cart-item-title {
      font-size: 16px;
      color: #00ffff;
      margin-bottom: 8px;
      font-weight: bold;
    }

    .cart-item-price {
      color: #00ff88;
      font-size: 18px;
      font-weight: bold;
    }

    .cart-item-remove {
      color: #ff006e;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 18px;
    }

    .cart-item-remove:hover {
      transform: scale(1.2) rotate(90deg);
      color: #ff4d00;
    }

    .cart-total {
      padding: 20px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 12px;
      margin: 20px 0;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .cart-total-label {
      font-size: 18px;
      color: #00ffff;
      margin-bottom: 10px;
    }

    .cart-total-amount {
      font-size: 32px;
      color: #00ff88;
      font-weight: bold;
      text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
    }

    .cart-checkout-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border: none;
      border-radius: 12px;
      color: #000;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 20px;
    }

    .cart-checkout-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.5);
    }

    .cart-checkout-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Main Content */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      animation: fadeInUp 0.6s ease 0.4s both;
    }

    .section-title {
      font-size: 28px;
      margin-bottom: 20px;
      color: #00ffff;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
      animation: fadeInUp 0.6s ease;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 3px;
      background: linear-gradient(90deg, #00ffff, #a855f7);
      animation: expandWidth 1s ease 0.5s forwards;
    }

    @keyframes expandWidth {
      to { width: 100%; }
    }

    /* Filter Slider Container */
    .filter-slider-container {
      position: relative;
      margin-bottom: 20px;
      animation: fadeInUp 0.6s ease 0.5s both;
      overflow: hidden;
    }

    .filter-slider {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      scroll-behavior: smooth;
      padding: 10px 0;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .filter-slider::-webkit-scrollbar {
      display: none;
    }

    .filter-btn {
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 10px;
      color: #00ffff;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .filter-btn:hover {
      background: rgba(0, 255, 255, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.3);
    }

    .filter-btn.active {
      background: linear-gradient(135deg, #00ffff, #a855f7);
      color: #000;
      border-color: transparent;
    }

    /* Product Grid - 2 columns */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 18px;
      margin-bottom: 40px;
      padding: 0;
    }

    .product-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 15px;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      animation: scaleIn 0.5s ease backwards;
    }

    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .product-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(168, 85, 247, 0.1));
      opacity: 0;
      transition: opacity 0.4s ease;
      z-index: 0;
    }

    .product-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 15px 45px rgba(0, 255, 255, 0.4);
      border-color: rgba(0, 255, 255, 0.5);
    }

    .product-card:hover::before {
      opacity: 1;
    }

    .product-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: linear-gradient(135deg, #ff006e, #ff4d00);
      color: #fff;
      padding: 4px 10px;
      border-radius: 15px;
      font-size: 11px;
      font-weight: bold;
      z-index: 2;
      animation: pulse 2s ease-in-out infinite;
    }

    .product-image {
      width: 100%;
      height: 180px;
      object-fit: contain;
      border-radius: 12px;
      margin-bottom: 12px;
      border: 2px solid rgba(0, 255, 255, 0.3);
      position: relative;
      z-index: 1;
      transition: all 0.4s ease;
      background: rgba(0, 0, 0, 0.3);
    }

    .product-card:hover .product-image {
      transform: scale(1.05);
      box-shadow: 0 8px 32px rgba(0, 255, 255, 0.4);
    }

    .product-title {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #00ffff;
      position: relative;
      z-index: 1;
      transition: all 0.3s ease;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .product-card:hover .product-title {
      transform: translateX(3px);
    }

    .product-description {
      font-size: 13px;
      color: #999;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .product-price-section {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }

    .product-price-original {
      text-decoration: line-through;
      color: #666;
      font-size: 14px;
    }

    .product-price-discount {
      color: #00ff88;
      font-size: 20px;
      font-weight: bold;
      text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    }

    .product-actions {
      display: flex;
      gap: 8px;
      position: relative;
      z-index: 1;
    }

    .btn {
      flex: 1;
      padding: 10px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border: none;
      border-radius: 10px;
      color: #000;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn:active::before {
      width: 300px;
      height: 300px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 255, 255, 0.5);
    }

    .btn-free-download {
      flex: 1;
      padding: 10px;
      background: linear-gradient(135deg, #00ff88, #00ffff);
      border: none;
      border-radius: 10px;
      color: #000;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .btn-free-download:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 255, 136, 0.5);
    }

    .btn-icon {
      width: 38px;
      height: 38px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #00ffff;
      font-size: 14px;
    }

    .btn-icon:hover {
      background: rgba(0, 255, 255, 0.2);
      border-color: #00ffff;
      transform: translateY(-2px) rotate(10deg);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.4);
    }

    .btn-icon.active {
      background: linear-gradient(135deg, #ff006e, #ff4d00);
      border-color: transparent;
      color: #fff;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      padding: 20px;
      overflow-y: auto;
      animation: fadeIn 0.3s ease;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: rgba(10, 10, 10, 0.98);
      backdrop-filter: blur(30px);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 24px;
      padding: 30px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 16px 64px rgba(0, 255, 255, 0.3);
      animation: modalSlideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      position: relative;
    }

    /* Chat Modal Full Screen */
    #chatModal .modal-content {
      max-width: 100%;
      width: 100%;
      height: 100vh;
      max-height: 100vh;
      border-radius: 0;
      padding: 20px;
      margin: 0;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px) scale(0.8);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      background: rgba(255, 0, 110, 0.2);
      border: 1px solid #ff006e;
      border-radius: 50%;
      color: #ff006e;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .modal-close:hover {
      background: #ff006e;
      color: #fff;
      transform: rotate(90deg) scale(1.1);
      box-shadow: 0 4px 16px rgba(255, 0, 110, 0.5);
    }

    .modal-image {
      width: 100%;
      height: 300px;
      object-fit: contain;
      border-radius: 16px;
      margin: 20px 0;
      border: 2px solid rgba(0, 255, 255, 0.3);
      animation: zoomIn 0.5s ease;
      background: rgba(0, 0, 0, 0.3);
    }

    @keyframes zoomIn {
      from {
        opacity: 0;
        transform: scale(0.5);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .modal-title {
      font-size: 28px;
      margin-bottom: 15px;
      color: #00ffff;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
      animation: slideInLeft 0.5s ease 0.2s both;
    }

    .modal-description {
      margin-bottom: 20px;
      color: #ccc;
      line-height: 1.8;
      animation: slideInLeft 0.5s ease 0.3s both;
    }

    /* Screenshots Section */
    .screenshots-section {
      margin: 20px 0;
      animation: slideInLeft 0.5s ease 0.4s both;
    }

    .screenshots-title {
      font-size: 18px;
      color: #00ffff;
      margin-bottom: 15px;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .screenshots-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
      margin-bottom: 20px;
    }

    .screenshot-item {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 12px;
      border: 2px solid rgba(0, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      background: rgba(0, 0, 0, 0.3);
    }

    .screenshot-item:hover {
      transform: scale(1.05);
      border-color: #00ffff;
      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.4);
    }

    .price-section {
      margin-bottom: 25px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      border: 1px solid rgba(0, 255, 255, 0.2);
      animation: slideInLeft 0.5s ease 0.4s both;
      position: relative;
      overflow: hidden;
    }

    .price-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
      animation: slideRight 2s ease infinite;
    }

    @keyframes slideRight {
      to { left: 100%; }
    }

    .price-original {
      text-decoration: line-through;
      color: #999;
      font-size: 18px;
      margin-right: 15px;
    }

    .price-discount {
      color: #00ff88;
      font-size: 32px;
      font-weight: bold;
      text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
    }

    .discount-badge {
      display: inline-block;
      background: linear-gradient(135deg, #ff006e, #ff4d00);
      color: #fff;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
      margin-left: 10px;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .btn-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 20px;
      animation: slideInUp 0.5s ease 0.5s both;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .btn-secondary {
      background: linear-gradient(135deg, #a855f7, #ff006e);
    }

    .btn-full {
      grid-column: 1 / -1;
    }

    .input-group {
      margin-bottom: 15px;
      animation: fadeIn 0.5s ease backwards;
    }

    .input-group:nth-child(1) { animation-delay: 0.1s; }
    .input-group:nth-child(2) { animation-delay: 0.2s; }
    .input-group:nth-child(3) { animation-delay: 0.3s; }
    .input-group:nth-child(4) { animation-delay: 0.4s; }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      color: #00ffff;
      font-size: 14px;
      font-weight: 500;
    }

    .input-group input,
    .input-group textarea {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .input-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .input-group input:focus,
    .input-group textarea:focus {
      outline: none;
      border-color: #00ffff;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
      background: rgba(255, 255, 255, 0.08);
      transform: scale(1.02);
    }

    .input-group input::placeholder,
    .input-group textarea::placeholder {
      color: #666;
    }

    .qr-image {
      width: 100%;
      max-width: 300px;
      height: auto;
      margin: 20px auto;
      display: block;
      border-radius: 16px;
      border: 2px solid #00ffff;
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
      animation: pulse 2s ease-in-out infinite;
    }

    .info-text {
      text-align: center;
      color: #00ffff;
      margin: 15px 0;
      font-size: 16px;
      animation: fadeIn 0.5s ease 0.3s both;
    }

    /* Coupon Section */
    .coupon-section {
      margin: 20px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      border: 1px solid rgba(0, 255, 255, 0.2);
      animation: slideInUp 0.5s ease 0.6s both;
    }

    .coupon-title {
      font-size: 18px;
      color: #00ffff;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .coupon-input-wrapper {
      display: flex;
      gap: 10px;
    }

    .coupon-input {
      flex: 1;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      text-transform: uppercase;
    }

    .coupon-apply-btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border: none;
      border-radius: 12px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .coupon-apply-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.5);
    }

    .coupon-message {
      margin-top: 10px;
      padding: 10px;
      border-radius: 8px;
      font-size: 14px;
      animation: slideInUp 0.3s ease;
    }

    .coupon-message.success {
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      color: #00ff88;
    }

    .coupon-message.error {
      background: rgba(255, 0, 110, 0.1);
      border: 1px solid #ff006e;
      color: #ff006e;
    }

    .applied-coupon {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      border-radius: 10px;
      margin-top: 10px;
      animation: slideInUp 0.3s ease;
    }

    .applied-coupon-code {
      color: #00ff88;
      font-weight: bold;
      font-size: 16px;
    }

    .applied-coupon-remove {
      color: #ff006e;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.3s ease;
    }

    .applied-coupon-remove:hover {
      transform: scale(1.2);
    }

    .price-breakdown {
      margin-top: 20px;
      padding: 15px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
    }

    .price-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 16px;
    }

    .price-row.total {
      border-top: 1px solid rgba(0, 255, 255, 0.3);
      padding-top: 10px;
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
      color: #00ff88;
    }

    .price-row .label {
      color: #999;
    }

    .price-row .value {
      color: #fff;
      font-weight: 500;
    }

    .price-row .discount-value {
      color: #ff006e;
    }

    /* Contact Page */
    .contact-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 8px 32px rgba(0, 255, 255, 0.15);
      animation: scaleIn 0.5s ease;
    }

    .contact-item {
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      border-left: 3px solid #00ffff;
      transition: all 0.3s ease;
    }

    .contact-item:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateX(5px);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.2);
    }

    .contact-label {
      color: #00ffff;
      font-size: 14px;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .contact-value {
      color: #fff;
      font-size: 16px;
      font-weight: 500;
    }

    .social-links {
      display: flex;
      gap: 15px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .social-btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border: none;
      border-radius: 12px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .social-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.5);
    }

    /* Accordion */
    .accordion {
      margin-bottom: 40px;
      animation: fadeInUp 0.6s ease 0.3s both;
    }

    .accordion-item {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      margin-bottom: 15px;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .accordion-item:hover {
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    .accordion-header {
      padding: 20px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #00ffff;
      font-weight: bold;
      font-size: 16px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .accordion-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .accordion-header:hover::before {
      left: 100%;
    }

    .accordion-header:hover {
      background: rgba(0, 255, 255, 0.1);
    }

    .accordion-icon {
      transition: transform 0.4s ease;
      font-size: 20px;
    }

    .accordion-item.active .accordion-icon {
      transform: rotate(180deg);
      color: #a855f7;
    }

    .accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      padding: 0 20px;
    }

    .accordion-item.active .accordion-content {
      max-height: 1000px;
      padding: 0 20px 20px;
    }

    .accordion-text {
      color: #ccc;
      line-height: 1.8;
      animation: fadeIn 0.5s ease;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 80px 20px;
      color: #999;
      animation: fadeIn 0.5s ease;
    }

    .empty-icon {
      font-size: 80px;
      margin-bottom: 20px;
      opacity: 0.5;
      animation: float 3s ease-in-out infinite;
    }

    .empty-title {
      font-size: 24px;
      color: #00ffff;
      margin-bottom: 10px;
    }

    .empty-text {
      font-size: 16px;
      line-height: 1.6;
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 40px 0;
      animation: fadeInUp 0.6s ease;
    }

    .pagination-btn {
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 10px;
      color: #00ffff;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .pagination-btn:hover {
      background: rgba(0, 255, 255, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.3);
    }

    .pagination-btn.active {
      background: linear-gradient(135deg, #00ffff, #a855f7);
      color: #000;
      border-color: transparent;
    }

    .pagination-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: none;
    }

    /* Stats Cards */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
      animation: fadeInUp 0.6s ease 0.2s both;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 255, 0.1), transparent);
      transform: rotate(45deg);
      transition: all 0.6s ease;
    }

    .stat-card:hover::before {
      top: 150%;
      right: 150%;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 40px rgba(0, 255, 255, 0.3);
      border-color: rgba(0, 255, 255, 0.5);
    }

    .stat-icon {
      font-size: 36px;
      margin-bottom: 10px;
      color: #00ffff;
      animation: bounce 2s ease-in-out infinite;
    }

    .stat-value {
      font-size: 28px;
      font-weight: bold;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 5px;
    }

    .stat-label {
      color: #999;
      font-size: 14px;
    }

    /* Order History Card */
    .order-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 20px;
      transition: all 0.3s ease;
      animation: slideInLeft 0.5s ease backwards;
    }

    .order-card:hover {
      transform: translateX(5px);
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.3);
      border-color: rgba(0, 255, 255, 0.5);
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(0, 255, 255, 0.2);
    }

    .order-id {
      color: #a855f7;
      font-weight: bold;
      font-size: 14px;
    }

    .order-date {
      color: #999;
      font-size: 12px;
    }

    .order-status {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      animation: pulse 2s ease-in-out infinite;
    }

    .order-status.pending {
      background: rgba(255, 165, 0, 0.2);
      color: #ffa500;
      border: 1px solid #ffa500;
    }

    .order-status.confirmed {
      background: rgba(0, 255, 136, 0.2);
      color: #00ff88;
      border: 1px solid #00ff88;
    }

    .order-status.processing {
      background: rgba(0, 255, 255, 0.2);
      color: #00ffff;
      border: 1px solid #00ffff;
    }

    .order-body {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
    }

    .order-image {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .order-details {
      flex: 1;
    }

    .order-product-title {
      font-size: 16px;
      color: #00ffff;
      margin-bottom: 8px;
      font-weight: bold;
    }

    .order-price {
      color: #00ff88;
      font-size: 18px;
      font-weight: bold;
    }

    .order-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid rgba(0, 255, 255, 0.2);
      flex-wrap: wrap;
      gap: 10px;
    }

    .order-utr {
      font-size: 12px;
      color: #999;
    }

    .order-utr strong {
      color: #00ffff;
    }

    .download-btn {
      padding: 8px 16px;
      background: linear-gradient(135deg, #00ff88, #00ffff);
      border: none;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 255, 136, 0.5);
    }

    .download-btn i {
      font-size: 14px;
    }

    /* Confirm Dialog */
    .confirm-dialog {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 10, 0.98);
      backdrop-filter: blur(30px);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 20px;
      padding: 30px;
      z-index: 10002;
      display: none;
      animation: scaleIn 0.3s ease;
      box-shadow: 0 16px 64px rgba(0, 255, 255, 0.4);
      min-width: 320px;
    }

    .confirm-dialog.active {
      display: block;
    }

    .confirm-dialog-title {
      font-size: 22px;
      color: #00ffff;
      margin-bottom: 15px;
      font-weight: bold;
      text-align: center;
    }

    .confirm-dialog-message {
      color: #ccc;
      margin-bottom: 25px;
      text-align: center;
      line-height: 1.6;
    }

    .confirm-dialog-buttons {
      display: flex;
      gap: 10px;
    }

    .confirm-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .confirm-btn.yes {
      background: linear-gradient(135deg, #ff006e, #ff4d00);
      color: #fff;
    }

    .confirm-btn.no {
      background: rgba(255, 255, 255, 0.1);
      color: #00ffff;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .confirm-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.4);
    }

    /* Chat Box Styles */
    .chat-container {
      display: flex;
      flex-direction: column;
      height: calc(100vh - 180px);
      max-height: none;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(0, 255, 255, 0.2);
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .chat-message {
      display: flex;
      gap: 10px;
      animation: slideInLeft 0.3s ease;
    }

    .chat-message.user {
      flex-direction: row-reverse;
      animation: slideInRight 0.3s ease;
    }

    .chat-message-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-weight: bold;
      flex-shrink: 0;
    }

    .chat-message.user .chat-message-avatar {
      background: linear-gradient(135deg, #a855f7, #ff006e);
    }

    .chat-message-content {
      max-width: 70%;
      padding: 12px 16px;
      border-radius: 16px;
      background: rgba(0, 255, 255, 0.1);
      border: 1px solid rgba(0, 255, 255, 0.3);
      color: #fff;
      line-height: 1.5;
    }

    .chat-message.user .chat-message-content {
      background: rgba(168, 85, 247, 0.1);
      border-color: rgba(168, 85, 247, 0.3);
    }

    .chat-message-time {
      font-size: 11px;
      color: #999;
      margin-top: 5px;
    }

    .chat-input-container {
      display: flex;
      gap: 10px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-top: 1px solid rgba(0, 255, 255, 0.2);
    }

    .chat-input {
      flex: 1;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 12px;
      color: #fff;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .chat-input:focus {
      outline: none;
      border-color: #00ffff;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
      background: rgba(255, 255, 255, 0.08);
    }

    .chat-send-btn {
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border: none;
      border-radius: 12px;
      color: #000;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chat-send-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 16px rgba(0, 255, 255, 0.5);
    }

    .chat-send-btn:active {
      transform: scale(0.95);
    }

    .chat-empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: #999;
      gap: 10px;
    }

    .chat-empty-icon {
      font-size: 60px;
      opacity: 0.5;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #a855f7, #00ffff);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .products-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }

      /* Chat Modal Mobile Full Screen */
      #chatModal .modal-content {
        padding: 15px;
        height: 100vh;
        border-radius: 0;
      }

      .chat-container {
        height: calc(100vh - 150px);
      }

      .btn-group {
        grid-template-columns: 1fr;
      }

      .modal-content {
        padding: 20px;
        margin: 10px;
      }

      .brand-name {
        font-size: 16px;
      }

      .section-title {
        font-size: 24px;
      }

      .header-icons {
        gap: 10px;
      }

      .stats-container {
        grid-template-columns: 1fr;
      }

      .coupon-input-wrapper {
        flex-direction: column;
      }

      .order-body {
        flex-direction: column;
      }

      .order-footer {
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }

      .product-image {
        height: 150px;
      }

      .product-title {
        font-size: 14px;
      }

      .product-description {
        font-size: 12px;
      }

      .screenshots-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }

      .screenshot-item {
        height: 100px;
      }

      .chat-message-content {
        max-width: 85%;
      }
    }

    @media (min-width: 769px) and (max-width: 1024px) {
      .products-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Animations for page transitions */
    @keyframes pageTransition {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .page-transition {
      animation: pageTransition 0.5s ease;
    }

    /* Shimmer Loading Effect */
    .shimmer {
      background: linear-gradient(90deg, 
        rgba(255, 255, 255, 0.05) 0%, 
        rgba(255, 255, 255, 0.1) 50%, 
        rgba(255, 255, 255, 0.05) 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    .shimmer-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .shimmer-image {
      width: 100%;
      height: 220px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      margin-bottom: 15px;
    }

    .shimmer-text {
      height: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .shimmer-text.short {
      width: 60%;
    }

    /* Floating Action Button */
    .fab {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #00ffff, #a855f7);
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      color: #000;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.5);
      transition: all 0.3s ease;
      z-index: 100;
      animation: fadeIn 0.3s ease;
    }

    .fab:hover {
      transform: scale(1.1) rotate(10deg);
      box-shadow: 0 12px 32px rgba(0, 255, 255, 0.7);
    }

    .fab.show {
      display: flex;
    }

    /* Success Animation */
    @keyframes successPulse {
      0%, 100% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.1);
        opacity: 0.8;
      }
    }

    .success-animation {
      animation: successPulse 0.6s ease;
    }

    /* Particle Background Effect */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #00ffff;
      border-radius: 50%;
      opacity: 0.3;
      animation: particleFloat 20s linear infinite;
    }

    @keyframes particleFloat {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 0.3;
      }
      90% {
        opacity: 0.3;
      }
      100% {
        transform: translateY(-100vh) translateX(100px);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading...</div>
    </div>
  </div>

  <!-- Notification Toast -->
  <div class="notification-toast" id="notificationToast"></div>

  <!-- Confirm Dialog -->
  <div class="confirm-dialog" id="confirmDialog">
    <div class="confirm-dialog-title" id="confirmTitle">Confirm Action</div>
    <div class="confirm-dialog-message" id="confirmMessage">Are you sure?</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-btn no" id="confirmNo">Cancel</button>
      <button class="confirm-btn yes" id="confirmYes">Confirm</button>
    </div>
  </div>

  <!-- Header -->
  <div class="header">
    <div class="hamburger" id="hamburger" onclick="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <div class="brand-section">
      <img id="headerLogo" class="brand-logo" src="" alt="Logo" style="display:none;">
      <div id="headerBrandName" class="brand-name">Premium Shop</div>
    </div>
    <div class="header-icons">
      <div class="header-icon" onclick="toggleCart()" title="Shopping Cart">
        <i class="fas fa-shopping-cart"></i>
        <span class="badge" id="cartBadge" style="display: none;">0</span>
      </div>
    </div>
  </div>

  <!-- Sidebar Menu -->
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleMenu()"></div>
  <div class="sidebar" id="sidebar">
    <div id="menuContent"></div>
  </div>

  <!-- Cart Sidebar -->
  <div class="cart-sidebar" id="cartSidebar">
    <div class="cart-header">
      <div class="cart-title"><i class="fas fa-shopping-cart"></i> Cart</div>
      <div class="cart-close" onclick="toggleCart()"></div>
    </div>
    <div id="cartItems"></div>
    <div class="cart-total" id="cartTotal" style="display: none;">
      <div class="cart-total-label">Total Amount:</div>
      <div class="cart-total-amount" id="cartTotalAmount">0</div>
    </div>
    <button class="cart-checkout-btn" id="cartCheckoutBtn" onclick="checkoutCart()" disabled>
      <i class="fas fa-credit-card"></i> Proceed to Checkout
    </button>
  </div>

  <!-- Search Bar -->
  <div class="search-container">
    <div class="search-wrapper">
      <input type="text" class="search-bar" id="searchBar" placeholder=" Search products..." oninput="searchProducts()">
      <span class="search-icon"><i class="fas fa-search"></i></span>
    </div>
  </div>

  <!-- Main Container -->
  <div class="container">
    <div id="mainContent">
      <!-- Filter Slider Container -->
      <div class="filter-slider-container" id="filterSliderContainer" style="display: none;">
        <div class="filter-slider" id="filterSlider">
          <button class="filter-btn active" data-filter="all" onclick="filterProducts('all')">
  <i class="fas fa-th"></i> All Products
</button>
<button class="filter-btn" data-filter="premium" onclick="filterProducts('premium')">
  <i class="fas fa-star"></i> Premium Product
</button>
<button class="filter-btn" data-filter="budget" onclick="filterProducts('budget')">
  <i class="fas fa-fire"></i> Budget Friendly
</button>
<button class="filter-btn" data-filter="free" onclick="filterProducts('free')">
  <i class="fas fa-tag"></i> Free Product
</button>
        </div>
      </div>

      <h2 class="section-title"><i class="fas fa-shopping-bag"></i> Products</h2>
      <div id="productsGrid" class="products-grid"></div>
      
      <!-- Pagination -->
      <div class="pagination" id="pagination" style="display: none;"></div>
    </div>
  </div>

  <!-- Product Detail Modal -->
  <div id="productModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('productModal')"></span>
      <img id="modalImage" class="modal-image" src="" alt="Product">
      <h2 id="modalTitle" class="modal-title"></h2>
      <p id="modalDescription" class="modal-description"></p>
      
      <!-- Screenshots Section -->
      <div class="screenshots-section" id="screenshotsSection" style="display: none;">
        <div class="screenshots-title">
          <i class="fas fa-images"></i> Product Screenshots
        </div>
        <div class="screenshots-grid" id="screenshotsGrid"></div>
      </div>

      <div class="price-section">
        <span id="modalPriceOriginal" class="price-original"></span>
        <span id="modalPriceDiscount" class="price-discount"></span>
        <span id="modalDiscountBadge" class="discount-badge" style="display: none;"></span>
      </div>
      <div class="btn-group" id="modalButtonGroup">
        <!-- Buttons will be dynamically added based on price -->
      </div>
    </div>
  </div>

  <!-- Checkout Modal -->
  <div id="checkoutModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('checkoutModal')"></span>
      <h2 class="modal-title"><i class="fas fa-credit-card"></i> Checkout</h2>
      
      <div id="checkoutItems"></div>

      <!-- Coupon Section -->
      <div class="coupon-section">
        <div class="coupon-title"><i class="fas fa-ticket-alt"></i> Have a Coupon Code?</div>
        <div id="appliedCouponDisplay" style="display: none;"></div>
        <div id="couponInputSection">
          <div class="coupon-input-wrapper">
            <input type="text" class="coupon-input" id="couponInput" placeholder="Enter coupon code" maxlength="20">
            <button class="coupon-apply-btn" onclick="applyCoupon()">
              <i class="fas fa-check"></i> Apply
            </button>
          </div>
          <div id="couponMessage" style="display: none;"></div>
        </div>
      </div>

      <!-- Price Breakdown -->
      <div class="price-breakdown">
        <div class="price-row">
          <span class="label">Subtotal:</span>
          <span class="value" id="checkoutSubtotal">0</span>
        </div>
        <div class="price-row" id="discountRow" style="display: none;">
          <span class="label">Discount:</span>
          <span class="discount-value" id="checkoutDiscount">-0</span>
        </div>
        <div class="price-row total">
          <span class="label">Total:</span>
          <span class="value" id="checkoutTotal">0</span>
        </div>
      </div>

      <div class="btn-group">
        <button class="btn btn-secondary" onclick="closeModal('checkoutModal')">
          <i class="fas fa-arrow-left"></i> Back
        </button>
        <button class="btn" onclick="proceedToPayment()">
          <i class="fas fa-arrow-right"></i> Proceed to Pay
        </button>
      </div>
    </div>
  </div>

  <!-- Payment Modal (QR) -->
  <div id="paymentModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('paymentModal')"></span>
      <h2 class="modal-title"><i class="fas fa-qrcode"></i> Complete Payment</h2>
      
      <div class="price-section">
        <div style="text-align: center;">
          <div style="color: #999; margin-bottom: 10px;">Total Amount to Pay</div>
          <span class="price-discount" id="paymentAmount">0</span>
        </div>
      </div>

      <img class="qr-image" src="https://i.ibb.co/0jgtbwVQ/Screenshot-20251022-204904-3.webp" alt="QR Code">
      <p class="info-text">
        <i class="fas fa-info-circle"></i> Scan the QR code and complete payment. Enter your payment details below to confirm your order.
      </p>
      
      <div class="input-group">
        <label><i class="fas fa-rupee-sign"></i> Enter Your Amount</label>
        <input type="number" id="userAmount" placeholder="Enter amount you paid" min="1" required>
        <small style="color: #999; font-size: 12px; margin-top: 5px; display: block;">
          Enter the exact amount you paid via UPI/Bank Transfer
        </small>
      </div>

      <div class="input-group">
        <label><i class="fas fa-receipt"></i> UTR ID / Transaction ID</label>
        <input type="text" id="utrId" placeholder="Enter 10-16 character UTR ID" maxlength="16" required>
        <small style="color: #999; font-size: 12px; margin-top: 5px; display: block;">
          UTR ID is found in your payment confirmation message/screenshot
        </small>
      </div>
      
      <div class="btn-group">
        <button class="btn btn-secondary" onclick="closeModal('paymentModal')">
          <i class="fas fa-times"></i> Cancel
        </button>
        <button class="btn" onclick="confirmPurchase()">
          <i class="fas fa-check"></i> Confirm Order
        </button>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div id="authModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('authModal')"></span>
      <h2 class="modal-title" id="authTitle"><i class="fas fa-sign-in-alt"></i> Login</h2>
      
      <div id="loginForm">
        <div class="input-group">
          <label><i class="fas fa-envelope"></i> Email</label>
          <input type="email" id="loginEmail" placeholder="your@email.com" autocomplete="email">
        </div>
        <div class="input-group">
          <label><i class="fas fa-lock"></i> Password</label>
          <input type="password" id="loginPassword" placeholder="Enter password" autocomplete="current-password">
        </div>
        <button class="btn btn-full" onclick="loginUser()">
          <i class="fas fa-sign-in-alt"></i> Login
        </button>
        <p style="text-align: center; margin-top: 15px; color: #999;">
          Don't have an account? <span style="color: #00ffff; cursor: pointer; font-weight: bold;" onclick="switchToSignup()">Sign up</span>
        </p>
      </div>

      <div id="signupForm" style="display: none;">
        <div class="input-group">
          <label><i class="fas fa-user"></i> Full Name</label>
          <input type="text" id="signupName" placeholder="Your name" autocomplete="name">
        </div>
        <div class="input-group">
          <label><i class="fas fa-envelope"></i> Email</label>
          <input type="email" id="signupEmail" placeholder="your@email.com" autocomplete="email">
        </div>
        <div class="input-group">
          <label><i class="fas fa-lock"></i> Password (min 6 characters)</label>
          <input type="password" id="signupPassword" placeholder="Create password" autocomplete="new-password">
        </div>
        <button class="btn btn-full" onclick="signupUser()">
          <i class="fas fa-user-plus"></i> Create Account
        </button>
        <p style="text-align: center; margin-top: 15px; color: #999;">
          Already have an account? <span style="color: #00ffff; cursor: pointer; font-weight: bold;" onclick="switchToLogin()">Login</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Admin Support Chat Modal -->
  <div id="chatModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('chatModal')"></span>
      <h2 class="modal-title"><i class="fas fa-headset"></i> Admin Support</h2>
      
      <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
          <div class="chat-empty-state">
            <div class="chat-empty-icon"></div>
            <div>Start a conversation with admin</div>
          </div>
        </div>
        <div class="chat-input-container">
          <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." maxlength="500">
          <button class="chat-send-btn" onclick="sendMessage()">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Screenshot Preview Modal -->
  <div id="screenshotModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('screenshotModal')"></span>
      <img id="screenshotPreview" class="modal-image" src="" alt="Screenshot" style="height: auto; max-height: 70vh;">
    </div>
  </div>

  <!-- Floating Action Button -->
  <div class="fab" id="fab" onclick="scrollToTop()">
    <i class="fas fa-arrow-up"></i>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js';
    import { getDatabase, ref, set, get, push, onValue, remove, update, query, orderByChild, limitToLast } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBnz1UbLyz0f6t83D2222XlmKNhKLdFzQM",
      authDomain: "digit-product.firebaseapp.com",
      databaseURL: "https://digit-product-default-rtdb.firebaseio.com",
      projectId: "digit-product",
      storageBucket: "digit-product.firebasestorage.app",
      messagingSenderId: "866989324771",
      appId: "1:866989324771:web:922bcc61814ab6cd6d88d6",
      measurementId: "G-48R5B4E6H8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    window.auth = auth;
    window.db = db;
    window.dbRef = ref;
    window.dbSet = set;
    window.dbGet = get;
    window.dbPush = push;
    window.dbOnValue = onValue;
    window.dbRemove = remove;
    window.dbUpdate = update;
    window.dbQuery = query;
    window.dbOrderByChild = orderByChild;
    window.dbLimitToLast = limitToLast;
    window.authCreateUser = createUserWithEmailAndPassword;
    window.authSignIn = signInWithEmailAndPassword;
    window.authSignOut = signOut;
    window.authUpdateProfile = updateProfile;

    window.currentUser = null;
    window.allProducts = [];
    window.currentProduct = null;
    window.cart = [];
    window.appliedCoupon = null;
    window.currentFilter = 'all';
    window.confirmCallback = null;

    // Check auth state
    onAuthStateChanged(auth, (user) => {
      window.currentUser = user;
      updateMenu();
      loadProducts();
      loadCartFromStorage();
      if (user) {
        loadChatMessages();
      }
    });

    // Load brand settings
    async function loadBrandSettings() {
      try {
        const snapshot = await get(ref(db, 'meta/brand'));
        if (snapshot.exists()) {
          const data = snapshot.val();
          if (data.logoUrl) {
            document.getElementById('headerLogo').src = data.logoUrl;
            document.getElementById('headerLogo').style.display = 'block';
          }
          if (data.name) {
            document.getElementById('headerBrandName').textContent = data.name;
          }
        }
      } catch (error) {
        console.error('Error loading brand:', error);
      }
    }

    loadBrandSettings();

    // Real-time listeners for products
    onValue(ref(db, 'products'), (snapshot) => {
      if (snapshot.exists()) {
        window.allProducts = Object.entries(snapshot.val()).map(([id, product]) => ({
          id,
          ...product
        }));
        displayProducts(window.allProducts);
      }
    });
  </script>

  <script>
    // Global variables
    let isLoading = false;
    const ITEMS_PER_PAGE = 12;
    let currentPage = 1;

    // Show loading overlay
    function showLoading(text = 'Loading...') {
      const overlay = document.getElementById('loadingOverlay');
      overlay.querySelector('.loading-text').textContent = text;
      overlay.classList.add('active');
      isLoading = true;
    }

    // Hide loading overlay
    function hideLoading() {
      document.getElementById('loadingOverlay').classList.remove('active');
      isLoading = false;
    }

    // Show notification
    function showNotification(message, type = 'success') {
      const toast = document.getElementById('notificationToast');
      toast.textContent = message;
      toast.className = `notification-toast show ${type}`;
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Show confirm dialog
    function showConfirmDialog(title, message, callback) {
      document.getElementById('confirmTitle').textContent = title;
      document.getElementById('confirmMessage').textContent = message;
      document.getElementById('confirmDialog').classList.add('active');
      window.confirmCallback = callback;
    }

    // Hide confirm dialog
    function hideConfirmDialog() {
      document.getElementById('confirmDialog').classList.remove('active');
      window.confirmCallback = null;
    }

    // Confirm dialog event listeners
    document.getElementById('confirmYes').addEventListener('click', function() {
      if (window.confirmCallback) {
        window.confirmCallback(true);
      }
      hideConfirmDialog();
    });

    document.getElementById('confirmNo').addEventListener('click', function() {
      if (window.confirmCallback) {
        window.confirmCallback(false);
      }
      hideConfirmDialog();
    });

    // Toggle menu
    function toggleMenu() {
      document.getElementById('hamburger').classList.toggle('active');
      document.getElementById('sidebar').classList.toggle('active');
      document.getElementById('sidebarOverlay').classList.toggle('active');
      document.body.style.overflow = document.getElementById('sidebar').classList.contains('active') ? 'hidden' : '';
    }

    // Update menu based on auth state
    function updateMenu() {
      const menuContent = document.getElementById('menuContent');
      const user = window.currentUser;

      if (user) {
        menuContent.innerHTML = `
          <div class="menu-username">
            <i class="fas fa-user-circle"></i><br>
            ${escapeHtml(user.displayName || user.email)}
          </div>
          <div class="menu-item" onclick="showProducts()">
            <i class="fas fa-shopping-bag"></i> Products
          </div>
          <div class="menu-item" onclick="showPurchaseHistory()">
            <i class="fas fa-history"></i> Purchase History
          </div>
          <div class="menu-item" onclick="showBookmarks()">
            <i class="fas fa-bookmark"></i> Bookmarks
          </div>
          <div class="menu-item" onclick="showAdminSupport()">
            <i class="fas fa-headset"></i> Admin Support
          </div>
          <div class="menu-item" onclick="window.open('https://epiczone.gamer.gd', '_blank')">
            <i class="fas fa-gamepad"></i> Get Coupon by Playing Games
          </div>
          <div class="menu-item" onclick="showContact()">
            <i class="fas fa-phone"></i> Contact Us
          </div>
          <div class="menu-item" onclick="logoutUser()">
            <i class="fas fa-sign-out-alt"></i> Logout
          </div>
        `;
      } else {
        menuContent.innerHTML = `
          <div class="menu-item" onclick="showProducts()">
            <i class="fas fa-shopping-bag"></i> Products
          </div>
          <div class="menu-item" onclick="requireLogin('view bookmarks')">
            <i class="fas fa-bookmark"></i> Bookmarks
          </div>
          <div class="menu-item" onclick="requireLogin('contact admin support')">
            <i class="fas fa-headset"></i> Admin Support
          </div>
          <div class="menu-item" onclick="window.open('https://epiczone.gamer.gd', '_blank')">
            <i class="fas fa-gamepad"></i> Get Coupon by Playing Games
          </div>
          <div class="menu-item" onclick="showContact()">
            <i class="fas fa-phone"></i> Contact Us
          </div>
          <div class="menu-item" onclick="showAuth()">
            <i class="fas fa-sign-in-alt"></i> Login / Signup
          </div>
        `;
      }
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Format currency
    function formatCurrency(amount) {
      return '' + parseFloat(amount).toLocaleString('en-IN', {
        minimumFractionDigits: 0,
        maximumFractionDigits: 2
      });
    }

    // Calculate discount percentage
    function calculateDiscountPercent(original, discounted) {
      const discount = ((original - discounted) / original) * 100;
      return Math.round(discount);
    }

    // Load products
    async function loadProducts() {
      try {
        if (window.allProducts.length === 0) {
          showLoading('Loading products...');
          const snapshot = await window.dbGet(window.dbRef(window.db, 'products'));
          hideLoading();
          
          if (snapshot.exists()) {
            window.allProducts = Object.entries(snapshot.val()).map(([id, product]) => ({
              id,
              ...product
            })).sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));
            
            displayProducts(window.allProducts);
          } else {
            displayEmptyState('products');
          }
        } else {
          displayProducts(window.allProducts);
        }
      } catch (error) {
        hideLoading();
        console.error('Error loading products:', error);
        showNotification('Failed to load products', 'error');
      }
    }

    // Display products
    function displayProducts(products) {
      const grid = document.getElementById('productsGrid');
      grid.innerHTML = '';

      if (products.length === 0) {
        displayEmptyState('products');
        document.getElementById('filterSliderContainer').style.display = 'none';
        return;
      }

      // Pagination
      const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
      const endIndex = startIndex + ITEMS_PER_PAGE;
      const paginatedProducts = products.slice(startIndex, endIndex);

      paginatedProducts.forEach((product, index) => {
        const card = createProductCard(product, index);
        grid.appendChild(card);
      });

      // Update pagination
      updatePagination(products.length);

      // Show filter slider
      document.getElementById('filterSliderContainer').style.display = 'block';
    }

    // Create product card
function createProductCard(product, index) {
  const card = document.createElement('div');
  card.className = 'product-card';
  card.style.animationDelay = `${index * 0.1}s`;
  
  const discountPercent = calculateDiscountPercent(product.realPrice, product.discountedPrice);
  const showBadge = discountPercent >= 10;
  const isFree = parseFloat(product.discountedPrice) === 0;

  card.innerHTML = `
    ${showBadge && !isFree ? `<div class="product-badge">${discountPercent}% OFF</div>` : ''}
    ${isFree ? `<div class="product-badge" style="background: linear-gradient(135deg, #00ff88, #00ffff);">FREE</div>` : ''}
    <img src="${escapeHtml(product.imageUrl)}" alt="${escapeHtml(product.title)}" class="product-image" 
         onerror="this.src='https://via.placeholder.com/300x180/1a0a2e/00ffff?text=No+Image'" loading="lazy">
    <div class="product-title">${escapeHtml(product.title)}</div>
    <div class="product-description">${escapeHtml(product.description || '')}</div>
    <div class="product-price-section">
      ${!isFree ? `<span class="product-price-original">${formatCurrency(product.realPrice)}</span>` : ''}
      <span class="product-price-discount">${isFree ? 'FREE' : formatCurrency(product.discountedPrice)}</span>
    </div>
    <div class="product-actions">
      <button class="btn" onclick="showProductDetail('${product.id}')">
        <i class="fas fa-eye"></i> View
      </button>
      ${!isFree ? `
        <button class="btn-icon" onclick="quickAddToCart('${product.id}'); event.stopPropagation();" title="Quick Add to Cart">
          <i class="fas fa-cart-plus"></i>
        </button>
      ` : ''}
    </div>
  `;

  card.onclick = (e) => {
    if (!e.target.closest('button')) {
      showProductDetail(product.id);
    }
  };

  return card;
}

    // Show product detail
    async function showProductDetail(productId) {
      try {
        showLoading('Loading product...');
        const snapshot = await window.dbGet(window.dbRef(window.db, `products/${productId}`));
        hideLoading();
        
        if (snapshot.exists()) {
          window.currentProduct = { id: productId, ...snapshot.val() };
          const product = window.currentProduct;

          document.getElementById('modalImage').src = product.imageUrl;
          document.getElementById('modalTitle').textContent = product.title;
          document.getElementById('modalDescription').textContent = product.description;
          
          const isFree = parseFloat(product.discountedPrice) === 0;
          
          if (!isFree) {
            document.getElementById('modalPriceOriginal').textContent = formatCurrency(product.realPrice);
            document.getElementById('modalPriceOriginal').style.display = 'inline';
          } else {
            document.getElementById('modalPriceOriginal').style.display = 'none';
          }
          
          document.getElementById('modalPriceDiscount').textContent = isFree ? 'FREE' : formatCurrency(product.discountedPrice);

          const discountPercent = calculateDiscountPercent(product.realPrice, product.discountedPrice);
          const badge = document.getElementById('modalDiscountBadge');
          if (discountPercent >= 10 && !isFree) {
            badge.textContent = `Save ${discountPercent}%`;
            badge.style.display = 'inline-block';
          } else {
            badge.style.display = 'none';
          }

          // Display screenshots if available
          const screenshotsSection = document.getElementById('screenshotsSection');
          const screenshotsGrid = document.getElementById('screenshotsGrid');
          
          if (product.screenshots && product.screenshots.length > 0) {
            screenshotsGrid.innerHTML = '';
            product.screenshots.forEach((screenshot, idx) => {
              const img = document.createElement('img');
              img.src = screenshot;
              img.alt = `Screenshot ${idx + 1}`;
              img.className = 'screenshot-item';
              img.onclick = () => showScreenshotPreview(screenshot);
              img.onerror = function() {
                this.style.display = 'none';
              };
              screenshotsGrid.appendChild(img);
            });
            screenshotsSection.style.display = 'block';
          } else {
            screenshotsSection.style.display = 'none';
          }

          // Update buttons based on price
          const buttonGroup = document.getElementById('modalButtonGroup');

          if (isFree) {
            buttonGroup.innerHTML = `
              <button class="btn btn-free-download btn-full" onclick="window.open('${escapeHtml(product.downloadLink || '#')}', '_blank')">
                <i class="fas fa-download"></i> Free Download
              </button>
              <button class="btn-icon" id="bookmarkBtn" onclick="toggleBookmark()" title="Bookmark">
                <i class="far fa-bookmark"></i>
              </button>
            `;
          } else {
            buttonGroup.innerHTML = `
              <button class="btn" onclick="addToCart()">
                <i class="fas fa-shopping-cart"></i> Add to Cart
              </button>
              <button class="btn btn-secondary" onclick="buyNow()">
                <i class="fas fa-bolt"></i> Buy Now
              </button>
              <button class="btn-icon" id="bookmarkBtn" onclick="toggleBookmark()" title="Bookmark">
                <i class="far fa-bookmark"></i>
              </button>
            `;
          }

          // Update bookmark button
          await updateBookmarkButton();

          document.getElementById('productModal').classList.add('active');
          document.body.style.overflow = 'hidden';
        }
      } catch (error) {
        hideLoading();
        console.error('Error loading product:', error);
        showNotification('Failed to load product', 'error');
      }
    }

    // Show screenshot preview
    function showScreenshotPreview(imageUrl) {
      document.getElementById('screenshotPreview').src = imageUrl;
      document.getElementById('screenshotModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    // Update bookmark button
    async function updateBookmarkButton() {
      const btn = document.getElementById('bookmarkBtn');
      if (!window.currentUser || !window.currentProduct) {
        btn.querySelector('i').className = 'far fa-bookmark';
        return;
      }

      try {
        const snapshot = await window.dbGet(
          window.dbRef(window.db, `users/${window.currentUser.uid}/bookmarks/${window.currentProduct.id}`)
        );
        
        if (snapshot.exists()) {
          btn.querySelector('i').className = 'fas fa-bookmark';
          btn.classList.add('active');
        } else {
          btn.querySelector('i').className = 'far fa-bookmark';
          btn.classList.remove('active');
        }
      } catch (error) {
        console.error('Error checking bookmark:', error);
      }
    }

    // Toggle bookmark
    async function toggleBookmark() {
      if (!window.currentUser) {
        closeModal('productModal');
        showNotification('Please login to bookmark products', 'error');
        showAuth();
        return;
      }

      if (!window.currentProduct) return;

      try {
        const bookmarkRef = window.dbRef(
          window.db,
          `users/${window.currentUser.uid}/bookmarks/${window.currentProduct.id}`
        );
        
        const snapshot = await window.dbGet(bookmarkRef);
        const btn = document.getElementById('bookmarkBtn');
        
        if (snapshot.exists()) {
          await window.dbRemove(bookmarkRef);
          btn.querySelector('i').className = 'far fa-bookmark';
          btn.classList.remove('active');
          showNotification('Removed from bookmarks', 'success');
        } else {
          await window.dbSet(bookmarkRef, {
            productId: window.currentProduct.id,
            addedAt: new Date().toISOString()
          });
          btn.querySelector('i').className = 'fas fa-bookmark';
          btn.classList.add('active');
          showNotification('Added to bookmarks', 'success');
        }
      } catch (error) {
        console.error('Error toggling bookmark:', error);
        showNotification('Failed to update bookmark', 'error');
      }
    }

    // Search products
    function searchProducts() {
      const query = document.getElementById('searchBar').value.toLowerCase().trim();
      
      let filtered = window.allProducts;

      if (query) {
        filtered = window.allProducts.filter(product => 
          product.title.toLowerCase().includes(query) ||
          (product.description && product.description.toLowerCase().includes(query))
        );
      }

      // Apply current filter
      if (window.currentFilter !== 'all') {
        filtered = applyFilter(filtered, window.currentFilter);
      }

      currentPage = 1;
      displayProducts(filtered);

      if (query && filtered.length === 0) {
        displayEmptyState('search');
      }
    }

    // Filter products
    function filterProducts(filter) {
      window.currentFilter = filter;
      
      // Update active button
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.filter === filter) {
          btn.classList.add('active');
        }
      });

      let filtered = window.allProducts;

      if (filter !== 'all') {
        filtered = applyFilter(window.allProducts, filter);
      }

      currentPage = 1;
      displayProducts(filtered);
    }

    // Apply filter logic
function applyFilter(products, filter) {
  switch(filter) {
    case 'premium':
      // Premium Products: Price between 199 to 2999
      return products.filter(p => {
        const price = parseFloat(p.discountedPrice);
        return price >= 199 && price <= 2999;
      });
    
    case 'budget':
      // Budget Friendly: Price between 1 to 198
      return products.filter(p => {
        const price = parseFloat(p.discountedPrice);
        return price >= 1 && price <= 198;
      });
    
    case 'free':
      // Free Products: Price is 0
      return products.filter(p => {
        const price = parseFloat(p.discountedPrice);
        return price === 0;
      });
    
    default:
      // All Products
      return products;
  }
}

    // Update pagination
    function updatePagination(totalItems) {
      const pagination = document.getElementById('pagination');
      const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);

      if (totalPages <= 1) {
        pagination.style.display = 'none';
        return;
      }

      pagination.style.display = 'flex';
      pagination.innerHTML = '';

      // Previous button
      const prevBtn = document.createElement('button');
      prevBtn.className = 'pagination-btn';
      prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i> Previous';
      prevBtn.disabled = currentPage === 1;
      prevBtn.onclick = () => {
        if (currentPage > 1) {
          currentPage--;
          displayProducts(getFilteredProducts());
          scrollToTop();
        }
      };
      pagination.appendChild(prevBtn);

      // Page numbers
      for (let i = 1; i <= totalPages; i++) {
        if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
          const pageBtn = document.createElement('button');
          pageBtn.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
          pageBtn.textContent = i;
          pageBtn.onclick = () => {
            currentPage = i;
            displayProducts(getFilteredProducts());
            scrollToTop();
          };
          pagination.appendChild(pageBtn);
        } else if (i === currentPage - 2 || i === currentPage + 2) {
          const dots = document.createElement('span');
          dots.textContent = '...';
          dots.style.padding = '10px';
          dots.style.color = '#999';
          pagination.appendChild(dots);
        }
      }

      // Next button
      const nextBtn = document.createElement('button');
      nextBtn.className = 'pagination-btn';
      nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
      nextBtn.disabled = currentPage === totalPages;
      nextBtn.onclick = () => {
        if (currentPage < totalPages) {
          currentPage++;
          displayProducts(getFilteredProducts());
          scrollToTop();
        }
      };
      pagination.appendChild(nextBtn);
    }

    // Get filtered products
    function getFilteredProducts() {
      const query = document.getElementById('searchBar').value.toLowerCase().trim();
      let filtered = window.allProducts;

      if (query) {
        filtered = filtered.filter(product => 
          product.title.toLowerCase().includes(query) ||
          (product.description && product.description.toLowerCase().includes(query))
        );
      }

      if (window.currentFilter !== 'all') {
        filtered = applyFilter(filtered, window.currentFilter);
      }

      return filtered;
    }

    // Cart functions
    function loadCartFromStorage() {
      try {
        const savedCart = localStorage.getItem('shoppingCart');
        if (savedCart) {
          window.cart = JSON.parse(savedCart);
          updateCartUI();
        }
      } catch (error) {
        console.error('Error loading cart:', error);
        window.cart = [];
      }
    }

    function saveCartToStorage() {
      try {
        localStorage.setItem('shoppingCart', JSON.stringify(window.cart));
      } catch (error) {
        console.error('Error saving cart:', error);
      }
    }

    function updateCartUI() {
      const badge = document.getElementById('cartBadge');
      const cartItems = document.getElementById('cartItems');
      const cartTotal = document.getElementById('cartTotal');
      const cartTotalAmount = document.getElementById('cartTotalAmount');
      const checkoutBtn = document.getElementById('cartCheckoutBtn');

      if (window.cart.length === 0) {
        badge.style.display = 'none';
        cartItems.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon"></div>
            <div class="empty-title">Cart is Empty</div>
            <div class="empty-text">Add products to your cart to get started!</div>
          </div>
        `;
        cartTotal.style.display = 'none';
        checkoutBtn.disabled = true;
        return;
      }

      badge.textContent = window.cart.length;
      badge.style.display = 'block';
      cartTotal.style.display = 'block';
      checkoutBtn.disabled = false;

      let total = 0;
      cartItems.innerHTML = '';

      window.cart.forEach((item, index) => {
        total += parseFloat(item.price);
        
        const cartItem = document.createElement('div');
        cartItem.className = 'cart-item';
        cartItem.innerHTML = `
          <img src="${escapeHtml(item.image)}" alt="${escapeHtml(item.title)}" class="cart-item-image"
               onerror="this.src='https://via.placeholder.com/80/1a0a2e/00ffff?text=No+Image'">
          <div class="cart-item-details">
            <div class="cart-item-title">${escapeHtml(item.title)}</div>
            <div class="cart-item-price">${formatCurrency(item.price)}</div>
          </div>
          <div class="cart-item-remove" onclick="removeFromCart(${index})" title="Remove">
            <i class="fas fa-times"></i>
          </div>
        `;
        cartItems.appendChild(cartItem);
      });

      cartTotalAmount.textContent = formatCurrency(total);
    }

    function toggleCart() {
      const cartSidebar = document.getElementById('cartSidebar');
      const overlay = document.getElementById('sidebarOverlay');
      
      cartSidebar.classList.toggle('active');
      overlay.classList.toggle('active');
      
      if (cartSidebar.classList.contains('active')) {
        document.body.style.overflow = 'hidden';
      } else {
        document.body.style.overflow = '';
      }
    }

    async function addToCart() {
      if (!window.currentProduct) return;

      const product = window.currentProduct;
      const cartItem = {
        id: product.id,
        title: product.title,
        price: product.discountedPrice,
        image: product.imageUrl
      };

      window.cart.push(cartItem);
      saveCartToStorage();
      updateCartUI();
      
      showNotification(`${product.title} added to cart!`, 'success');
      
      // Close modal and open cart
      closeModal('productModal');
      setTimeout(() => {
        toggleCart();
      }, 300);
    }

    async function quickAddToCart(productId) {
      try {
        const snapshot = await window.dbGet(window.dbRef(window.db, `products/${productId}`));
        
        if (snapshot.exists()) {
          const product = snapshot.val();
          const cartItem = {
            id: productId,
            title: product.title,
            price: product.discountedPrice,
            image: product.imageUrl
          };

          window.cart.push(cartItem);
          saveCartToStorage();
          updateCartUI();
          
          showNotification(`${product.title} added to cart!`, 'success');
        }
      } catch (error) {
        console.error('Error adding to cart:', error);
        showNotification('Failed to add to cart', 'error');
      }
    }

    function removeFromCart(index) {
      const removedItem = window.cart[index];
      
      showConfirmDialog(
        'Remove from Cart',
        `Are you sure you want to remove "${removedItem.title}" from cart?`,
        (confirmed) => {
          if (confirmed) {
            window.cart.splice(index, 1);
            saveCartToStorage();
            updateCartUI();
            showNotification(`${removedItem.title} removed from cart`, 'success');
          }
        }
      );
    }

    function clearCart() {
      window.cart = [];
      saveCartToStorage();
      updateCartUI();
    }

    // Buy Now function
    function buyNow() {
      if (!window.currentProduct) return;

      // Clear cart and add only this product
      window.cart = [{
        id: window.currentProduct.id,
        title: window.currentProduct.title,
        price: window.currentProduct.discountedPrice,
        image: window.currentProduct.imageUrl
      }];
      
      saveCartToStorage();
      updateCartUI();
      
      closeModal('productModal');
      
      setTimeout(() => {
        checkoutCart();
      }, 300);
    }

    // Checkout functions
    function checkoutCart() {
      if (!window.currentUser) {
        showNotification('Please login to checkout', 'error');
        showAuth();
        return;
      }

      if (window.cart.length === 0) {
        showNotification('Your cart is empty', 'error');
        return;
      }

      // Close cart sidebar if open
      document.getElementById('cartSidebar').classList.remove('active');
      document.getElementById('sidebarOverlay').classList.remove('active');

      // Display checkout items
      const checkoutItems = document.getElementById('checkoutItems');
      checkoutItems.innerHTML = '<h3 style="color: #00ffff; margin-bottom: 15px;"><i class="fas fa-shopping-bag"></i> Order Summary</h3>';

      window.cart.forEach(item => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'cart-item';
        itemDiv.innerHTML = `
          <img src="${escapeHtml(item.image)}" alt="${escapeHtml(item.title)}" class="cart-item-image"
               onerror="this.src='https://via.placeholder.com/80/1a0a2e/00ffff?text=No+Image'">
          <div class="cart-item-details">
            <div class="cart-item-title">${escapeHtml(item.title)}</div>
            <div class="cart-item-price">${formatCurrency(item.price)}</div>
          </div>
        `;
        checkoutItems.appendChild(itemDiv);
      });

      // Calculate totals
      const subtotal = window.cart.reduce((sum, item) => sum + parseFloat(item.price), 0);
      document.getElementById('checkoutSubtotal').textContent = formatCurrency(subtotal);
      document.getElementById('checkoutTotal').textContent = formatCurrency(subtotal);
      document.getElementById('discountRow').style.display = 'none';

      // Reset coupon
      window.appliedCoupon = null;
      document.getElementById('couponInput').value = '';
      document.getElementById('couponMessage').style.display = 'none';
      document.getElementById('appliedCouponDisplay').style.display = 'none';
      document.getElementById('couponInputSection').style.display = 'block';

      document.getElementById('checkoutModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    // Coupon functions
    async function applyCoupon() {
      const couponCode = document.getElementById('couponInput').value.trim().toUpperCase();
      
      if (!couponCode) {
        showCouponMessage('Please enter a coupon code', 'error');
        return;
      }

      try {
        showLoading('Validating coupon...');
        
        const couponsSnapshot = await window.dbGet(window.dbRef(window.db, 'coupons'));
        hideLoading();
        
        if (!couponsSnapshot.exists()) {
          showCouponMessage('Invalid coupon code', 'error');
          return;
        }

        const coupons = couponsSnapshot.val();
        let foundCoupon = null;
        let couponId = null;

        for (const [id, coupon] of Object.entries(coupons)) {
          if (coupon.code === couponCode) {
            foundCoupon = coupon;
            couponId = id;
            break;
          }
        }

        if (!foundCoupon) {
          showCouponMessage('Invalid coupon code', 'error');
          return;
        }

        // Validate coupon
        const now = Date.now();

        if (!foundCoupon.isActive) {
          showCouponMessage('This coupon is no longer active', 'error');
          return;
        }

        if (foundCoupon.expiryDate && new Date(foundCoupon.expiryDate).getTime() <= now) {
          showCouponMessage('This coupon has expired', 'error');
          return;
        }

        if (foundCoupon.usageLimit > 0 && (foundCoupon.usedCount || 0) >= foundCoupon.usageLimit) {
          showCouponMessage('This coupon has reached its usage limit', 'error');
          return;
        }

        const subtotal = window.cart.reduce((sum, item) => sum + parseFloat(item.price), 0);

        if (foundCoupon.minAmount > 0 && subtotal < foundCoupon.minAmount) {
          showCouponMessage(`Minimum purchase amount is ${formatCurrency(foundCoupon.minAmount)}`, 'error');
          return;
        }

        // Calculate discount
        let discountAmount = 0;

        if (foundCoupon.discountType === 'percentage') {
          discountAmount = (subtotal * foundCoupon.discountValue) / 100;
          
          if (foundCoupon.maxDiscount > 0 && discountAmount > foundCoupon.maxDiscount) {
            discountAmount = foundCoupon.maxDiscount;
          }
        } else {
          discountAmount = foundCoupon.discountValue;
        }

        // Apply coupon
        window.appliedCoupon = {
          id: couponId,
          code: foundCoupon.code,
          discount: discountAmount
        };

        updateCheckoutTotals();
        
        // Show applied coupon
        document.getElementById('couponInputSection').style.display = 'none';
        document.getElementById('appliedCouponDisplay').innerHTML = `
          <div class="applied-coupon">
            <div>
              <i class="fas fa-ticket-alt"></i> 
              <span class="applied-coupon-code">${foundCoupon.code}</span>
              <span style="color: #00ff88; margin-left: 10px;">-${formatCurrency(discountAmount)}</span>
            </div>
            <div class="applied-coupon-remove" onclick="removeCoupon()">
              <i class="fas fa-times"></i>
            </div>
          </div>
        `;
        document.getElementById('appliedCouponDisplay').style.display = 'block';

        showNotification('Coupon applied successfully!', 'success');

      } catch (error) {
        hideLoading();
        console.error('Error applying coupon:', error);
        showCouponMessage('Failed to apply coupon', 'error');
      }
    }

    function removeCoupon() {
      window.appliedCoupon = null;
      document.getElementById('couponInput').value = '';
      document.getElementById('appliedCouponDisplay').style.display = 'none';
      document.getElementById('couponInputSection').style.display = 'block';
      updateCheckoutTotals();
      showNotification('Coupon removed', 'success');
    }

    function showCouponMessage(message, type) {
      const messageDiv = document.getElementById('couponMessage');
      messageDiv.textContent = message;
      messageDiv.className = `coupon-message ${type}`;
      messageDiv.style.display = 'block';
      
      setTimeout(() => {
        messageDiv.style.display = 'none';
      }, 3000);
    }

    function updateCheckoutTotals() {
      const subtotal = window.cart.reduce((sum, item) => sum + parseFloat(item.price), 0);
      document.getElementById('checkoutSubtotal').textContent = formatCurrency(subtotal);

      if (window.appliedCoupon) {
        document.getElementById('discountRow').style.display = 'flex';
        document.getElementById('checkoutDiscount').textContent = `-${formatCurrency(window.appliedCoupon.discount)}`;
        
        const total = Math.max(0, subtotal - window.appliedCoupon.discount);
        document.getElementById('checkoutTotal').textContent = formatCurrency(total);
      } else {
        document.getElementById('discountRow').style.display = 'none';
        document.getElementById('checkoutTotal').textContent = formatCurrency(subtotal);
      }
    }

    // Proceed to payment
    function proceedToPayment() {
      if (window.cart.length === 0) {
        showNotification('Cart is empty', 'error');
        return;
      }

      // Calculate total
      const subtotal = window.cart.reduce((sum, item) => sum + parseFloat(item.price), 0);
      const discount = window.appliedCoupon ? window.appliedCoupon.discount : 0;
      const total = Math.max(0, subtotal - discount);

      document.getElementById('paymentAmount').textContent = formatCurrency(total);

      closeModal('checkoutModal');
      
      setTimeout(() => {
        document.getElementById('paymentModal').classList.add('active');
        document.body.style.overflow = 'hidden';
      }, 300);
    }

    // Confirm purchase
    async function confirmPurchase() {
      const userAmount = document.getElementById('userAmount').value.trim();
      const utrId = document.getElementById('utrId').value.trim();

      // Validation
      if (!userAmount) {
        showNotification('Please enter the amount you paid', 'error');
        return;
      }

      if (!utrId) {
        showNotification('Please enter UTR ID', 'error');
        return;
      }

      const amountPaid = parseFloat(userAmount);
      if (isNaN(amountPaid) || amountPaid <= 0) {
        showNotification('Please enter a valid amount', 'error');
        return;
      }

      if (utrId.length < 10 || utrId.length > 16) {
        showNotification('UTR ID must be between 10 and 16 characters', 'error');
        return;
      }

      if (!/^[a-zA-Z0-9]+$/.test(utrId)) {
        showNotification('UTR ID must contain only letters and numbers', 'error');
        return;
      }

      try {
        showLoading('Processing your order...');

        // Calculate totals
        const subtotal = window.cart.reduce((sum, item) => sum + parseFloat(item.price), 0);
        const discount = window.appliedCoupon ? window.appliedCoupon.discount : 0;
        const total = Math.max(0, subtotal - discount);

        // Create orders for each product in cart
        for (const item of window.cart) {
          const orderRef = window.dbPush(window.dbRef(window.db, 'orders'));
          const orderId = orderRef.key;

          const orderData = {
            productId: item.id,
            amountPaid: amountPaid,
            productSnapshot: {
              title: item.title,
              imageUrl: item.image,
              discountedPrice: item.price
            },
            userInput: { 
              utrId,
              name: window.currentUser.displayName || 'N/A',
              email: window.currentUser.email,
              phone: 'N/A'
            },
            userId: window.currentUser.uid,
            userEmail: window.currentUser.email,
            couponUsed: window.appliedCoupon ? window.appliedCoupon.code : null,
            discountAmount: window.appliedCoupon ? window.appliedCoupon.discount : 0,
            finalAmount: total,
            status: 'pending',
            createdAt: new Date().toISOString()
          };

          await window.dbSet(orderRef, orderData);
          
          // Add to user's purchases
          await window.dbSet(
            window.dbRef(window.db, `users/${window.currentUser.uid}/purchases/${orderId}`),
            {
              orderId: orderId,
              productId: item.id,
              purchasedAt: new Date().toISOString()
            }
          );
        }

        // Update coupon usage if applied
        if (window.appliedCoupon) {
          const couponRef = window.dbRef(window.db, `coupons/${window.appliedCoupon.id}`);
          const couponSnapshot = await window.dbGet(couponRef);
          
          if (couponSnapshot.exists()) {
            const currentUsage = couponSnapshot.val().usedCount || 0;
            await window.dbUpdate(couponRef, {
              usedCount: currentUsage + 1
            });
          }
        }

        hideLoading();

        // Clear cart
        clearCart();
        window.appliedCoupon = null;

        // Clear form
        document.getElementById('userAmount').value = '';
        document.getElementById('utrId').value = '';

        closeModal('paymentModal');
        
        showNotification(' Order placed successfully! Check your purchase history.', 'success');

        // Show success animation
        setTimeout(() => {
          showPurchaseHistory();
        }, 1500);

      } catch (error) {
        hideLoading();
        console.error('Error placing order:', error);
        showNotification('Failed to place order: ' + error.message, 'error');
      }
    }

    // Show products page
    function showProducts() {
      toggleMenu();
      
      document.getElementById('mainContent').innerHTML = `
  <div class="filter-slider-container" id="filterSliderContainer">
    <div class="filter-slider" id="filterSlider">
      <button class="filter-btn active" data-filter="all" onclick="filterProducts('all')">
        <i class="fas fa-th"></i> All Products
      </button>
      <button class="filter-btn" data-filter="premium" onclick="filterProducts('premium')">
        <i class="fas fa-star"></i> Premium Product
      </button>
      <button class="filter-btn" data-filter="budget" onclick="filterProducts('budget')">
        <i class="fas fa-fire"></i> Budget Friendly
      </button>
      <button class="filter-btn" data-filter="free" onclick="filterProducts('free')">
        <i class="fas fa-tag"></i> Free Product
      </button>
    </div>
  </div>
  <h2 class="section-title"><i class="fas fa-shopping-bag"></i> Products</h2>
  <div id="productsGrid" class="products-grid"></div>
  <div class="pagination" id="pagination" style="display: none;"></div>
`;

      window.currentFilter = 'all';
      currentPage = 1;
      loadProducts();
      
      document.getElementById('searchBar').value = '';
    }

    // Show bookmarks
    async function showBookmarks() {
      if (!window.currentUser) {
        requireLogin('view bookmarks');
        return;
      }

      toggleMenu();
      
      try {
        showLoading('Loading bookmarks...');
        
        const snapshot = await window.dbGet(
          window.dbRef(window.db, `users/${window.currentUser.uid}/bookmarks`)
        );
        
        hideLoading();

        document.getElementById('mainContent').innerHTML = `
          <h2 class="section-title"><i class="fas fa-bookmark"></i> My Bookmarks</h2>
          <div id="bookmarksGrid" class="products-grid"></div>
        `;

        const grid = document.getElementById('bookmarksGrid');

        if (snapshot.exists()) {
          const bookmarks = snapshot.val();
          const bookmarkIds = Object.keys(bookmarks);
          
          // Load each bookmarked product
          const bookmarkedProducts = [];
          for (const productId of bookmarkIds) {
            const productSnapshot = await window.dbGet(
              window.dbRef(window.db, `products/${productId}`)
            );
            if (productSnapshot.exists()) {
              bookmarkedProducts.push({
                id: productId,
                ...productSnapshot.val()
              });
            }
          }
          
          if (bookmarkedProducts.length > 0) {
            bookmarkedProducts.forEach((product, index) => {
              const card = createProductCard(product, index);
              grid.appendChild(card);
            });
          } else {
            displayEmptyState('bookmarks');
          }
        } else {
          displayEmptyState('bookmarks');
        }
      } catch (error) {
        hideLoading();
        console.error('Error loading bookmarks:', error);
        showNotification('Failed to load bookmarks', 'error');
        displayEmptyState('bookmarks');
      }
    }

    // Show purchase history
    async function showPurchaseHistory() {
      if (!window.currentUser) {
        requireLogin('view purchase history');
        return;
      }

      toggleMenu();

      try {
        showLoading('Loading purchase history...');

        const snapshot = await window.dbGet(
          window.dbRef(window.db, `users/${window.currentUser.uid}/purchases`)
        );

        hideLoading();

        document.getElementById('mainContent').innerHTML = `
          <h2 class="section-title"><i class="fas fa-history"></i> Purchase History</h2>
          <div id="purchasesList"></div>
        `;

        const list = document.getElementById('purchasesList');

        if (snapshot.exists()) {
          const purchases = Object.values(snapshot.val())
            .sort((a, b) => new Date(b.purchasedAt) - new Date(a.purchasedAt));
          
          // Load order details for each purchase
          for (const purchase of purchases) {
            const orderSnapshot = await window.dbGet(
              window.dbRef(window.db, `orders/${purchase.orderId}`)
            );
            
            if (orderSnapshot.exists()) {
              const order = orderSnapshot.val();
              
              // Load product details to get download link
              const productSnapshot = await window.dbGet(
                window.dbRef(window.db, `products/${purchase.productId}`)
              );
              
              let downloadLink = null;
              if (productSnapshot.exists()) {
                downloadLink = productSnapshot.val().downloadLink || null;
              }
              
              const card = createOrderCard(purchase.orderId, order, downloadLink);
              list.appendChild(card);
            }
          }
        } else {
          displayEmptyState('orders');
        }
      } catch (error) {
        hideLoading();
        console.error('Error loading purchases:', error);
        showNotification('Failed to load purchase history', 'error');
        displayEmptyState('orders');
      }
    }

    // Create order card with download button
    function createOrderCard(orderId, order, downloadLink) {
      const card = document.createElement('div');
      card.className = 'order-card';
      
      const date = new Date(order.createdAt).toLocaleDateString('en-IN', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });

      const status = order.status || 'pending';
      const statusClass = status === 'confirmed' ? 'confirmed' : (status === 'processing' ? 'processing' : 'pending');
      const statusText = status.charAt(0).toUpperCase() + status.slice(1);

      // Show download button only if status is confirmed and download link exists
      const showDownloadBtn = status === 'confirmed' && downloadLink;

      card.innerHTML = `
        <div class="order-header">
          <div>
            <div class="order-id"><i class="fas fa-receipt"></i> Order #${orderId.substring(0, 8)}</div>
            <div class="order-date"><i class="far fa-clock"></i> ${date}</div>
          </div>
          <div class="order-status ${statusClass}">${statusText}</div>
        </div>
        <div class="order-body">
          <img src="${escapeHtml(order.productSnapshot?.imageUrl || '')}" 
               alt="${escapeHtml(order.productSnapshot?.title || 'Product')}" 
               class="order-image"
               onerror="this.src='https://via.placeholder.com/80/1a0a2e/00ffff?text=No+Image'">
          <div class="order-details">
            <div class="order-product-title">${escapeHtml(order.productSnapshot?.title || 'Product')}</div>
            <div class="order-price">${formatCurrency(order.finalAmount || order.productSnapshot?.discountedPrice || 0)}</div>
            ${order.couponUsed ? `<div style="font-size: 12px; color: #00ff88; margin-top: 5px;">
              <i class="fas fa-ticket-alt"></i> Coupon: ${escapeHtml(order.couponUsed)} 
              (-${formatCurrency(order.discountAmount || 0)})
            </div>` : ''}
          </div>
        </div>
        <div class="order-footer">
          <div class="order-utr">
            <strong>UTR ID:</strong> ${escapeHtml(order.userInput?.utrId || 'N/A')}
          </div>
          <div style="font-size: 12px; color: #999;">
            <i class="fas fa-user"></i> ${escapeHtml(order.userInput?.name || 'N/A')}
          </div>
          ${showDownloadBtn ? `
            <button class="download-btn" onclick="window.open('${escapeHtml(downloadLink)}', '_blank')">
              <i class="fas fa-download"></i> Download
            </button>
          ` : ''}
        </div>
      `;

      return card;
    }

    // Show admin support chat
    function showAdminSupport() {
      if (!window.currentUser) {
        requireLogin('contact admin support');
        return;
      }

      toggleMenu();
      
      document.getElementById('chatModal').classList.add('active');
      document.body.style.overflow = 'hidden';
      
      loadChatMessages();
    }

    // Load chat messages
    async function loadChatMessages() {
      if (!window.currentUser) return;

      try {
        const chatRef = window.dbRef(window.db, `chats/${window.currentUser.uid}/messages`);
        
        window.dbOnValue(chatRef, (snapshot) => {
          const messagesContainer = document.getElementById('chatMessages');
          messagesContainer.innerHTML = '';

          if (snapshot.exists()) {
            const messages = Object.entries(snapshot.val()).map(([id, msg]) => ({
              id,
              ...msg
            })).sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));

            messages.forEach(msg => {
              const messageDiv = createChatMessage(msg);
              messagesContainer.appendChild(messageDiv);
            });

            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
          } else {
            messagesContainer.innerHTML = `
              <div class="chat-empty-state">
                <div class="chat-empty-icon"></div>
                <div>Start a conversation with admin</div>
              </div>
            `;
          }
        });
      } catch (error) {
        console.error('Error loading chat messages:', error);
      }
    }

    // Create chat message element
    function createChatMessage(msg) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `chat-message ${msg.sender === 'user' ? 'user' : 'admin'}`;
      
      const time = new Date(msg.timestamp).toLocaleTimeString('en-IN', {
        hour: '2-digit',
        minute: '2-digit'
      });

      messageDiv.innerHTML = `
        <div class="chat-message-avatar">
          ${msg.sender === 'user' ? 'U' : 'A'}
        </div>
        <div>
          <div class="chat-message-content">
            ${escapeHtml(msg.message)}
          </div>
          <div class="chat-message-time">${time}</div>
        </div>
      `;

      return messageDiv;
    }

    // Send chat message
    async function sendMessage() {
      if (!window.currentUser) return;

      const input = document.getElementById('chatInput');
      const message = input.value.trim();

      if (!message) {
        showNotification('Please enter a message', 'error');
        return;
      }

      try {
        const chatRef = window.dbRef(window.db, `chats/${window.currentUser.uid}/messages`);
        const newMessageRef = window.dbPush(chatRef);

        await window.dbSet(newMessageRef, {
          message: message,
          sender: 'user',
          timestamp: new Date().toISOString(),
          userName: window.currentUser.displayName || window.currentUser.email
        });

        // Update chat info
        await window.dbSet(window.dbRef(window.db, `chats/${window.currentUser.uid}/info`), {
          lastMessage: message,
          lastMessageTime: new Date().toISOString(),
          userName: window.currentUser.displayName || window.currentUser.email,
          userEmail: window.currentUser.email
        });

        input.value = '';
        showNotification('Message sent', 'success');

      } catch (error) {
        console.error('Error sending message:', error);
        showNotification('Failed to send message', 'error');
      }
    }

    // Handle Enter key in chat input
    document.addEventListener('DOMContentLoaded', function() {
      const chatInput = document.getElementById('chatInput');
      if (chatInput) {
        chatInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });
      }
    });

    // Show contact page
    async function showContact() {
      toggleMenu();

      try {
        showLoading('Loading contact information...');
        
        const snapshot = await window.dbGet(window.dbRef(window.db, 'meta/contact'));
        
        hideLoading();

        let contactInfo = {};
        if (snapshot.exists()) {
          contactInfo = snapshot.val();
        }

        document.getElementById('mainContent').innerHTML = `
          <h2 class="section-title"><i class="fas fa-phone"></i> Contact Us</h2>
          <div class="contact-card page-transition">
            <div class="contact-item">
              <div class="contact-label"><i class="fas fa-store"></i> Brand Name</div>
              <div class="contact-value">${escapeHtml(contactInfo.brandName || 'N/A')}</div>
            </div>
            <div class="contact-item">
              <div class="contact-label"><i class="fas fa-user-tie"></i> Legal Operator</div>
              <div class="contact-value">${escapeHtml(contactInfo.operator || 'N/A')}</div>
            </div>
            <div class="contact-item">
              <div class="contact-label"><i class="fas fa-envelope"></i> Email</div>
              <div class="contact-value">${escapeHtml(contactInfo.email || 'N/A')}</div>
            </div>
            <div class="contact-item">
              <div class="contact-label"><i class="fas fa-phone"></i> Phone</div>
              <div class="contact-value">${escapeHtml(contactInfo.phone || 'N/A')}</div>
            </div>
            ${contactInfo.socialYoutube || contactInfo.socialTelegram ? `
              <div class="social-links">
                ${contactInfo.socialYoutube ? `
                  <a href="${escapeHtml(contactInfo.socialYoutube)}" target="_blank" class="social-btn">
                    <i class="fab fa-instagram"></i> Instagram
                  </a>
                ` : ''}
                ${contactInfo.socialTelegram ? `
                  <a href="${escapeHtml(contactInfo.socialTelegram)}" target="_blank" class="social-btn">
                    <i class="fab fa-telegram"></i> Telegram
                  </a>
                ` : ''}
              </div>
            ` : ''}
          </div>

          <h2 class="section-title" style="margin-top: 40px;"><i class="fas fa-file-contract"></i> Terms & Policies</h2>
          <div class="accordion page-transition">
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion(this)">
                <span><i class="fas fa-undo"></i> Refund Policy</span>
                <span class="accordion-icon"></span>
              </div>
              <div class="accordion-content">
                <p class="accordion-text">
                   Thank you for purchasing our digital product.
Please read this Refund & Cancellation Policy carefully before making a payment on our platform.

1. Instant Access

All our products are delivered instantly after successful payment.
Once payment is completed, the download link for your purchased digital item (HTML, ZIP, code file, etc.) becomes immediately available to you.

                </p>
              </div>
            </div>

            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion(this)">
                <span><i class="fas fa-file-contract"></i> Terms & Conditions</span>
                <span class="accordion-icon"></span>
              </div>
              <div class="accordion-content">
                <p class="accordion-text">
                  By using our service, you agree to our terms and conditions. All products are subject to availability. We reserve the right to modify prices and product offerings without prior notice. Users must provide accurate information during checkout. You are responsible for maintaining the confidentiality of your account. Unauthorized use of our service may result in account termination.
                </p>
              </div>
            </div>

            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion(this)">
                <span><i class="fas fa-shield-alt"></i> Privacy Policy</span>
                <span class="accordion-icon"></span>
              </div>
              <div class="accordion-content">
                <p class="accordion-text">
                  We collect and store user information securely using industry-standard encryption. Your data is used only for order processing, communication, and improving our services. We do not share your personal information with third parties without consent, except as required by law. Your payment information is processed securely through trusted payment gateways. You have the right to request access to, modification of, or deletion of your personal data at any time.
                </p>
              </div>
            </div>

            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion(this)">
                <span><i class="fas fa-credit-card"></i> Payment Policy</span>
                <span class="accordion-icon"></span>
              </div>
              <div class="accordion-content">
                <p class="accordion-text">
                  We accept payments through UPI, Bank Transfer, and other secure payment methods. All prices are in Indian Rupees () unless otherwise stated. Payment must be completed before product delivery or access. We use secure SSL encryption for all transactions. After payment, please provide the UTR/Transaction ID for verification. Orders are processed only after payment confirmation.
                </p>
              </div>
            </div>

            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion(this)">
                <span><i class="fas fa-ticket-alt"></i> Coupon Policy</span>
                <span class="accordion-icon"></span>
              </div>
              <div class="accordion-content">
                <p class="accordion-text">
                  Coupons are subject to terms and conditions specified at the time of issue. Only one coupon can be applied per order. Coupons cannot be combined with other offers unless explicitly stated. Expired coupons cannot be used or extended. Coupon discounts are applied to the product price before taxes and shipping. We reserve the right to cancel or modify coupons at any time without prior notice.
                </p>
              </div>
            </div>
          </div>
        `;
      } catch (error) {
        hideLoading();
        console.error('Error loading contact:', error);
        showNotification('Failed to load contact information', 'error');
      }
    }

    // Toggle accordion
    function toggleAccordion(header) {
      const item = header.parentElement;
      const wasActive = item.classList.contains('active');
      
      // Close all accordions
      document.querySelectorAll('.accordion-item').forEach(i => i.classList.remove('active'));
      
      // Open clicked accordion if it wasn't active
      if (!wasActive) {
        item.classList.add('active');
      }
    }

    // Auth functions
    function showAuth() {
      if (window.currentUser) {
        toggleMenu();
        return;
      }

      document.getElementById('authModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function switchToSignup() {
      document.getElementById('authTitle').innerHTML = '<i class="fas fa-user-plus"></i> Sign Up';
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('signupForm').style.display = 'block';
    }

    function switchToLogin() {
      document.getElementById('authTitle').innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
      document.getElementById('signupForm').style.display = 'none';
      document.getElementById('loginForm').style.display = 'block';
    }

    async function loginUser() {
      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPassword').value.trim();

      if (!email || !password) {
        showNotification('Please fill all fields', 'error');
        return;
      }

      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        showNotification('Please enter a valid email address', 'error');
        return;
      }

      try {
        showLoading('Logging in...');
        await window.authSignIn(window.auth, email, password);
        hideLoading();
        
        closeModal('authModal');
        
        document.getElementById('loginEmail').value = '';
        document.getElementById('loginPassword').value = '';
        
        showNotification(`Welcome back, ${window.currentUser.displayName || 'User'}!`, 'success');
      } catch (error) {
        hideLoading();
        console.error('Login error:', error);
        
        let errorMsg = 'Login failed';
        if (error.code === 'auth/user-not-found') {
          errorMsg = 'No account found with this email';
        } else if (error.code === 'auth/wrong-password') {
          errorMsg = 'Incorrect password';
        } else if (error.code === 'auth/invalid-email') {
          errorMsg = 'Invalid email format';
        } else if (error.code === 'auth/too-many-requests') {
          errorMsg = 'Too many failed attempts. Please try again later';
        } else {
          errorMsg = error.message;
        }
        
        showNotification(errorMsg, 'error');
      }
    }

    async function signupUser() {
      const name = document.getElementById('signupName').value.trim();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPassword').value.trim();

      if (!name || !email || !password) {
        showNotification('Please fill all fields', 'error');
        return;
      }

      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        showNotification('Please enter a valid email address', 'error');
        return;
      }

      if (password.length < 6) {
        showNotification('Password must be at least 6 characters', 'error');
        return;
      }

      try {
        showLoading('Creating account...');
        const userCredential = await window.authCreateUser(window.auth, email, password);
        await window.authUpdateProfile(userCredential.user, { displayName: name });
        
        // Create user profile in database
        await window.dbSet(window.dbRef(window.db, `users/${userCredential.user.uid}/profile`), {
          name: name,
          email: email,
          createdAt: new Date().toISOString()
        });
        
        hideLoading();
        
        closeModal('authModal');
        
        document.getElementById('signupName').value = '';
        document.getElementById('signupEmail').value = '';
        document.getElementById('signupPassword').value = '';
        
        showNotification(`Welcome to our store, ${name}!`, 'success');
      } catch (error) {
        hideLoading();
        console.error('Signup error:', error);
        
        let errorMsg = 'Signup failed';
        if (error.code === 'auth/email-already-in-use') {
          errorMsg = 'This email is already registered';
        } else if (error.code === 'auth/invalid-email') {
          errorMsg = 'Invalid email format';
        } else if (error.code === 'auth/weak-password') {
          errorMsg = 'Password is too weak';
        } else {
          errorMsg = error.message;
        }
        
        showNotification(errorMsg, 'error');
      }
    }

    async function logoutUser() {
      try {
        showLoading('Logging out...');
        await window.authSignOut(window.auth);
        hideLoading();
        
        toggleMenu();
        showProducts();
        
        showNotification('Logged out successfully', 'success');
      } catch (error) {
        hideLoading();
        console.error('Logout error:', error);
        showNotification('Logout failed', 'error');
      }
    }

    // Require login
    function requireLogin(feature) {
      toggleMenu();
      showNotification(`Please login to ${feature}`, 'error');
      setTimeout(() => {
        showAuth();
      }, 500);
    }

    // Close modal
    function closeModal(modalId) {
      document.getElementById(modalId).classList.remove('active');
      document.body.style.overflow = '';
    }

    // Close modal on outside click
    window.onclick = function(event) {
      if (event.target.classList.contains('modal')) {
        event.target.classList.remove('active');
        document.body.style.overflow = '';
      }
    }

    // Display empty state
    function displayEmptyState(type) {
      const grid = type === 'products' ? document.getElementById('productsGrid') : 
                   type === 'bookmarks' ? document.getElementById('bookmarksGrid') :
                   type === 'orders' ? document.getElementById('purchasesList') :
                   document.getElementById('productsGrid');

      const emptyStates = {
        products: {
          icon: '',
          title: 'No Products Available',
          text: 'Check back later for new products!'
        },
        search: {
          icon: '',
          title: 'No Results Found',
          text: 'Try different search terms'
        },
        bookmarks: {
          icon: '',
          title: 'No Bookmarks Yet',
          text: 'Bookmark your favorite products to find them easily later'
        },
        orders: {
          icon: '',
          title: 'No Orders Yet',
          text: 'Start shopping and your orders will appear here'
        }
      };

      const state = emptyStates[type] || emptyStates.products;

      grid.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">${state.icon}</div>
          <div class="empty-title">${state.title}</div>
          <div class="empty-text">${state.text}</div>
        </div>
      `;
    }

    // Scroll to top
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    // Show/hide FAB on scroll
    window.addEventListener('scroll', function() {
      const fab = document.getElementById('fab');
      if (window.scrollY > 500) {
        fab.classList.add('show');
      } else {
        fab.classList.remove('show');
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // Escape key closes modals and dialogs
      if (e.key === 'Escape') {
        document.querySelectorAll('.modal.active').forEach(modal => {
          modal.classList.remove('active');
          document.body.style.overflow = '';
        });
        
        if (document.getElementById('confirmDialog').classList.contains('active')) {
          hideConfirmDialog();
        }
        
        // Close cart sidebar
        if (document.getElementById('cartSidebar').classList.contains('active')) {
          toggleCart();
        }
        
        // Close menu sidebar
        if (document.getElementById('sidebar').classList.contains('active')) {
          toggleMenu();
        }
      }

      // Ctrl/Cmd + K focuses search
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('searchBar').focus();
      }
    });

    // Handle authentication state changes in realtime
    window.auth.onAuthStateChanged((user) => {
      if (user && !window.currentUser) {
        // User just logged in
        updateMenu();
      } else if (!user && window.currentUser) {
        // User just logged out
        updateMenu();
      }
    });

    // Prevent form submission on Enter key in modals
    document.querySelectorAll('.modal input').forEach(input => {
      input.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          
          const modal = this.closest('.modal');
          const submitBtn = modal.querySelector('.btn');
          if (submitBtn) {
            submitBtn.click();
          }
        }
      });
    });

    // Add smooth scroll behavior
    document.documentElement.style.scrollBehavior = 'smooth';

    // Initialize page
    window.addEventListener('load', function() {
      // Hide loading overlay if still showing
      hideLoading();
      
      // Load initial products
      loadProducts();
      
      // Update menu
      updateMenu();
      
      // Load cart from storage
      loadCartFromStorage();

      console.log('%c Premium Shop Loaded Successfully! ', 'color: #00ffff; font-size: 20px; font-weight: bold;');
      console.log('%c New Features: Free Download, Games Coupon Link, Fixed QR, Amount Input ', 'color: #a855f7; font-size: 14px;');
    });

    // Handle online/offline status
    window.addEventListener('online', () => {
      showNotification(' Connection restored', 'success');
    });

    window.addEventListener('offline', () => {
      showNotification(' You are offline. Some features may not work.', 'error');
    });

    // Auto-save cart on page unload
    window.addEventListener('beforeunload', function() {
      saveCartToStorage();
    });

    // Handle visibility change (tab switching)
    document.addEventListener('visibilitychange', function() {
      if (!document.hidden) {
        // Refresh data when user comes back to the tab
        if (window.currentUser) {
          loadProducts();
        }
      }
    });

    // Console art
    console.log(`
    
                                           
        PREMIUM SHOP - USER PANEL     
                                           
       Version: 3.1.0                      
       Features:                           
        Real-time Product Sync            
        Shopping Cart System              
        Coupon Management                 
        Bookmark Products                 
        Purchase History                  
        Download Links (Confirmed Orders) 
        Product Screenshots Gallery       
        Admin Support Chat                
        FREE Product Downloads            
        Games Coupon Link                 
        Fixed QR Code Payment             
        Amount Input Field                
        2-Column Grid Layout              
        Swipe Filter Slider               
        FIT_CENTER Product Images         
        Confirm Delete Dialog             
        Smooth Animations                 
        Mobile Responsive                 
                                           
       Connected to Firebase             
                                           
    
    `);

    // Debug mode (only in development)
    const DEBUG_MODE = false;

    if (DEBUG_MODE) {
      window.debugCart = () => console.log('Cart:', window.cart);
      window.debugUser = () => console.log('User:', window.currentUser);
      window.debugProducts = () => console.log('Products:', window.allProducts);
      console.log('%c Debug mode enabled. Use debugCart(), debugUser(), debugProducts()', 'color: #ffa500;');
    }
  </script>
</body>
</html>